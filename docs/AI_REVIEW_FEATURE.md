# AI审查功能使用说明

## 功能概述

PatentCheck-Desktop V0.9 现已集成基于DeepSeek大模型的AI审查功能，可以对专利申请文档进行智能审查和分析。

## 功能特性

### 1. 审查模式
- **独立使用**：可以单独对已检测的专利文档进行AI审查
- **同步执行**：可选择在形式检查完成后自动触发AI审查

### 2. 预设提示词
系统提供4个专业的预设审查提示词：
1. "请审查这份专利申请的技术方案完整性和逻辑性"
2. "请评估专利申请的创新性和实用性"
3. "请检查权利要求书的保护范围是否清晰合理"
4. "请分析专利申请中可能存在的法律风险"

用户也可以选择"自定义"并输入自己的审查提示词。

### 3. 审查结果输出
- 在GUI界面的AI审查结果区域实时显示
- 自动包含在PDF报告中
- 保存在JSON检测报告中

## 使用步骤

### 独立使用模式

1. 启动应用程序：`python src/gui/main_window.py`
2. 点击"📁 选择专利文件夹"，选择包含专利文档的文件夹
3. 点击"🔍 开始检测"完成形式检查
4. 在AI审查区域：
   - 从下拉框选择预设提示词，或选择"自定义"输入自己的提示词
   - 点击"🤖 开始AI审查"按钮
5. 等待审查完成，结果将显示在下方的文本框中

### 同步执行模式

1. 启动应用程序并选择文件夹
2. 在AI审查区域：
   - 选择审查提示词
   - 勾选"同步执行AI审查"复选框
3. 点击"🔍 开始检测"
4. 形式检查完成后，系统会自动执行AI审查

## 配置说明

### API密钥配置

在项目根目录的`.env`文件中配置DeepSeek API密钥：

```env
DEEPSEEK_API_KEY=your_api_key_here
```

**注意**：请将`your_api_key_here`替换为您的实际API密钥。

### 依赖安装

首次使用前需要安装新增的依赖：

```bash
pip install python-dotenv openai
```

或者安装所有依赖：

```bash
pip install -r requirements.txt
```

## 技术架构

### 模块结构

```
src/ai_reviewer/
├── __init__.py           # 模块初始化
├── deepseek_client.py    # DeepSeek API客户端封装
└── reviewer.py           # AI审查器核心逻辑
```

### 数据流

1. **文档提取**：从Word或PDF文档中提取文本内容
2. **请求组装**：将审查提示词与文档内容组合
3. **API调用**：通过DeepSeek API进行审查分析
4. **结果处理**：展示结果并保存到报告中

### 特点

- **多线程处理**：使用QThread避免GUI阻塞
- **错误处理**：完善的异常捕获和用户提示
- **灵活配置**：支持自定义提示词和同步/独立执行模式
- **完整集成**：审查结果自动包含在PDF和JSON报告中

## 注意事项

1. **网络连接**：AI审查功能需要互联网连接以访问DeepSeek API
2. **API费用**：DeepSeek API调用可能产生费用，请参考官方定价
3. **隐私保护**：文档内容会发送到DeepSeek服务器进行分析
4. **审查准确性**：AI审查结果仅供参考，不构成法律意见
5. **文档大小**：默认限制为10000字符，超过会自动截断

## 故障排查

### 问题1：API连接失败
**原因**：API密钥错误或网络问题
**解决方案**：
- 检查`.env`文件中的API密钥是否正确
- 确保网络连接正常
- 查看日志中的具体错误信息

### 问题2：文档读取失败
**原因**：文档格式不支持或文件损坏
**解决方案**：
- 确保文档为`.docx`或`.pdf`格式
- 检查文件是否损坏
- 尝试重新保存文档

### 问题3：审查按钮无法点击
**原因**：未先执行形式检查
**解决方案**：
- 必须先执行"开始检测"
- 确保检测到有效的说明书文档

## 更新日志

### V0.9.1 (2025-10-27)
- ✨ 新增基于DeepSeek的AI审查功能
- ✨ 支持4种预设审查提示词
- ✨ 支持自定义审查提示词
- ✨ 支持独立和同步两种执行模式
- ✨ AI审查结果自动包含在PDF报告中
- 🔧 更新核心数据模型以支持AI审查结果存储

## 联系支持

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件至项目维护者
